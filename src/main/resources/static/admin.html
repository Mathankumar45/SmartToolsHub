<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Admin — Pending Recharges</title>
  <style>
    body{font-family:Arial; padding:16px; background:#f3f6fb;}
    .card{background:white;padding:12px;margin:12px 0;border-radius:8px;box-shadow:0 3px 8px rgba(0,0,0,0.06);}
    button{padding:8px 10px;border-radius:6px;border:none;background:#0b5cff;color:white;cursor:pointer;}
  </style>
</head>
<body>
  <h2>Pending Transactions</h2>
  <div id="list"></div>

<script>
async function loadPending(){
  const res = await fetch('/api/admin/pending');
  const arr = await res.json();
  const container = document.getElementById('list');
  container.innerHTML = '';
  if(!arr || arr.length === 0){ container.innerHTML = '<div>No pending transactions</div>'; return; }
  arr.forEach(t => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `<div><strong>${t.serviceType}</strong> - ${t.provider} - ₹${t.amount}</div>
      <div>Account: ${t.accountNumber}</div>
      <div>Txn: ${t.transactionId}</div>
      <div>Status: ${t.status}</div>
      <div style="margin-top:8px;"><button onclick="mark('${t.transactionId}')">Mark Completed</button></div>`;
    container.appendChild(div);
  });
}

async function mark(txnId){
  if(!confirm('Mark transaction completed?')) return;
  const res = await fetch('/api/admin/complete/' + txnId, { method:'POST' });
  if(res.ok){
    alert('Marked completed & email sent');
    loadPending();
  } else {
    alert('Failed');
  }
}

loadPending();
</script>
</body>
</html>
